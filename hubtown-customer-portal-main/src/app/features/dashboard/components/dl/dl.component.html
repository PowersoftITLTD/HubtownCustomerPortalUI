<!-- Milestone & payment boxes -->
<div class="row gx-3">
  <div class="col-md-6 col-12 mb-3">
    <div class="HT-details-card">
      <div class="HT-card-head">
        <div class="HT-title">
          <div>
            <img src="images/letters-icon.svg" />
            <span class="dark-text">Demand Letters</span>
          </div>
        </div>
        <button
          class="btn btn-warning"
          type="button"
          data-bs-toggle="modal"
          data-bs-target="#receiptsModal"
          (click)="setDL()"
        >
          View Details
        </button>
      </div>
      <div class="card-body">
        @if(demandLetter$ | async ) { @for(demandLetter of (demandLetter$ |
        async)?.slice(0, 4); track $index){
        <div class="bordered">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <div class="download-file-box big-box p-0 border-0">
              <img src="images/attach-icon.svg" />
              <span class="pe-2">{{ demandLetter?.invoiceNo }}</span>
              @if(demandLetter?.invoiceUrl){
              <div class="button-container">
                <button
                  class="btn btn-download"
                  (click)="downloadFile(demandLetter?.invoiceUrl || '')"
                  [disabled]="!demandLetter.invoiceUrl"
                  [class.show-error]="!demandLetter.invoiceUrl"
                >
                  <img src="images/download-icon.svg" />
                </button>

                <!-- Error message -->
                <p *ngIf="!demandLetter.invoiceUrl" class="error-tooltip">
                  Demand Letters unavailable
                </p>
              </div>
              }
            </div>
            <div>
              <span class="text-gray">Description: </span>
              <span class="text-meduim">{{
                demandLetter.invoiceDescription
              }}</span>
            </div>
            <!-- <span class="tag danger"><i></i>pending</span> -->
          </div>
          <div class="d-flex align-items-center justify-content-between">
            <div class="text-meduim font-big">
              {{ formatToINRCurrency(demandLetter?.invoiceAmt) }}
            </div>

            <div>
              <span class="text-gray">Date:</span>
              <span class="text-meduim">
                {{
                  !demandLetter?.invoiceDate ||
                  demandLetter?.invoiceDate?.startsWith('1900')
                    ? '-'
                    : (demandLetter?.invoiceDate | date)
                }}
              </span>
            </div>
          </div>
        </div>
        } } @else {
        <p style="margin-left: 21px; padding: 10px">
          No demand letters available
        </p>
        }
      </div>
    </div>
  </div>
  <div class="col-md-6 col-12 mb-3">
    <div class="HT-details-card">
      <div class="HT-card-head">
        <div class="HT-title">
          <div>
            <img src="images/receipts-icon.svg" />
            <span class="dark-text">Receipts</span>
          </div>
        </div>
        <button
          class="btn btn-warning"
          type="button"
          data-bs-toggle="modal"
          data-bs-target="#receiptsModal"
          (click)="setReceipt()"
        >
          View Details
        </button>
      </div>
      <div class="card-body">
        @if(receipt$ | async) { @for(receipt of (receipt$ | async)?.slice(0, 4);
        track $index){
        <div class="bordered">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <div class="download-file-box big-box p-0 border-0">
              <img src="images/attach-icon.svg" />
              <span class="pe-2">{{ receipt?.receiptNo }}</span>

              <div class="button-container">
                @if (receipt?.receiptUrl) {
                <button
                  class="btn btn-download"
                  (click)="downloadFile(receipt?.receiptUrl || '')"
                  [disabled]="!receipt.receiptUrl"
                  [class.show-error]="!receipt.receiptUrl"
                >
                  <img src="images/download-icon.svg" alt="Download" />
                </button>
                }

                <!-- Error message -->
                <p *ngIf="!receipt.receiptUrl" class="error-tooltip">
                  Receipts unavailable
                </p>
              </div>
            </div>
            <!-- <span class="tag danger"><i></i>pending</span> -->
          </div>

          <div class="d-flex align-items-center justify-content-between">
            <div class="text-meduim font-big">
              {{ formatToINRCurrency(receipt?.receiptAmt) }}
            </div>
            <div>
              <span class="text-gray">Date: </span>
              <span class="text-meduim">
                {{
                  !receipt?.receiptDate ||
                  receipt?.receiptDate?.startsWith('1900')
                    ? '-'
                    : (receipt?.receiptDate | date)
                }}
              </span>
            </div>
          </div>
        </div>
        } } @else {
        <p style="margin-left: 21px; padding: 10px">No receipts available</p>
        }
      </div>
    </div>
  </div>
</div>
